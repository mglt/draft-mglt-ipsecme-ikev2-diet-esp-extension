<?xml version="1.0" encoding="UTF-8"?>
  <?xml-stylesheet type="text/xsl" href="rfc2629.xslt" ?>
  <!-- generated by https://github.com/cabo/kramdown-rfc version 1.7.8 (Ruby 3.0.2) -->


<!DOCTYPE rfc  [
  <!ENTITY nbsp    "&#160;">
  <!ENTITY zwsp   "&#8203;">
  <!ENTITY nbhy   "&#8209;">
  <!ENTITY wj     "&#8288;">

<!ENTITY RFC2119 SYSTEM "https://bib.ietf.org/public/rfc/bibxml/reference.RFC.2119.xml">
<!ENTITY RFC8174 SYSTEM "https://bib.ietf.org/public/rfc/bibxml/reference.RFC.8174.xml">
<!ENTITY I-D.ietf-ipsecme-diet-esp SYSTEM "https://bib.ietf.org/public/rfc/bibxml3/reference.I-D.ietf-ipsecme-diet-esp.xml">
<!ENTITY RFC7296 SYSTEM "https://bib.ietf.org/public/rfc/bibxml/reference.RFC.7296.xml">
<!ENTITY RFC4301 SYSTEM "https://bib.ietf.org/public/rfc/bibxml/reference.RFC.4301.xml">
]>


<rfc ipr="trust200902" docName="draft-ietf-ipsecme-ikev2-diet-esp-extension-02" category="std" consensus="true" submissionType="IETF" tocInclude="true" sortRefs="true" symRefs="true">
  <front>
    <title abbrev="EHC extension">Internet Key Exchange version 2 (IKEv2) extension for Header Compression Profile (HCP)</title>

    <author initials="D." surname="Migault" fullname="Daniel Migault">
      <organization>Ericsson</organization>
      <address>
        <email>daniel.migault@ericsson.com</email>
      </address>
    </author>
    <author initials="T." surname="Guggemos" fullname="Tobias Guggemos">
      <organization>LMU</organization>
      <address>
        <email>guggemos@nm.ifi.lmu.de</email>
      </address>
    </author>
    <author initials="D." surname="Schinazi" fullname="David Schinazi">
      <organization>Google LLC</organization>
      <address>
        <email>dschinazi.ietf@gmail.com</email>
      </address>
    </author>
    <author initials="W." surname="Atwood" fullname="J. William Atwood">
      <organization>Concordia University</organization>
      <address>
        <email>william.atwood@concordia.ca</email>
      </address>
    </author>
    <author initials="D." surname="Liu" fullname="Daiying Liu">
      <organization>Ericsson</organization>
      <address>
        <email>harold.liu@ericsson.com</email>
      </address>
    </author>
    <author initials="S." surname="Preda" fullname="Stere Preda">
      <organization>Ericsson</organization>
      <address>
        <email>stere.preda@ericsson.com</email>
      </address>
    </author>
    <author initials="M." surname="Hatami" fullname="Maryam Hatami">
      <organization>Concordia University</organization>
      <address>
        <email>maryam.hatami@mail.concordia.ca</email>
      </address>
    </author>
    <author initials="S." surname="Céspedes" fullname="Sandra Céspedes">
      <organization>Concordia University</organization>
      <address>
        <email>sandra.cespedes@concordia.ca</email>
      </address>
    </author>

    <date year="2025" month="January" day="21"/>

    <area>Security</area>
    <workgroup>IPsecme</workgroup>
    <keyword>Internet-Draft</keyword>

    <abstract>


<?line 62?>

<t>This document describes an IKEv2 extension for Header Compression to agree on Attributes for Rules Generation. 
This extension defines the necessary registries for the ESP Header Compression Profile (EHCP) Diet-ESP.</t>



    </abstract>



  </front>

  <middle>


<?line 67?>

<section anchor="requirements-notation"><name>Requirements notation</name>

<t>The key words "MUST", "MUST NOT", "REQUIRED", "SHALL", "SHALL
NOT", "SHOULD", "SHOULD NOT", "RECOMMENDED", "NOT RECOMMENDED",
"MAY", and "OPTIONAL" in this document are to be interpreted as
described in BCP 14 <xref target="RFC2119"/> <xref target="RFC8174"/> when, and only when, they
appear in all capitals, as shown here.
<?line -6?></t>

</section>
<section anchor="introduction"><name>Introduction</name>

<t>The ESP Header Compression Profile (EHCP) <xref target="I-D.ietf-ipsecme-diet-esp"/> minimizes the overhead associated with ESP by compressing both the ESP header and additional fields within the secured packet. EHCP utilizes Attributes for Rules Generation (AfRG) that are specified for each Security Association (SA). Certain AfRG have already been established during the SA negotiation process through IKEv2. This extension facilitates the agreement on the remaining AfRG through IKEv2.</t>

</section>
<section anchor="protocol-overview"><name>Protocol Overview</name>

<t>As illustrated in <xref target="fig-overview"/>, an initiator intending to utilize the Header Compression Profile (HCP) informs its peer by sending a HCP_PROPOSAL Notify Payload during the IKE_AUTH and CREATE_CHILD_SA exchanges. The HCP_PROPOSAL includes a list of Proposals, each comprising an EHCP Name along with a set of Attributes for Rules Generation (AfRG)<xref target="I-D.ietf-ipsecme-diet-esp"/>. Any AfRG for which the initiator wishes to specify no limitations SHOULD be excluded, i.e., an AfRG is only sent if the sending peer wants the receiving peer to select a subset of the available values. A given AfRG MAY be repeated with different values in order to provide a list of acceptable values. A range of possible AfRG values MAY be indicated as well.</t>

<t>If a Proposal contains an unknown HCP Name, or any AfRG in a Proposal is unknown, then the entire Proposal must be discarded by the responder. If none of the received Proposals are deemed acceptable, the responder MAY choose to discard the HCP_PROPOSAL Notify Payload. Nevertheless, it is anticipated that the responder will provide an explanation for rejecting all HCP Proposals. If the reason pertains to an AfRG with an unacceptable value, the responder SHOULD reply with a
NO_PROPOSAL_CHOSEN Notify Payload.</t>

<t>Conversely, if the receiver identifies a suitable Proposal, it will respond with an HCP_PROPOSAL Notify Payload that includes the chosen Proposal. In cases where the AfRG was not explicitly stated, the responder will provide the AfRG unless it defaults to a standard value. Each AfRG MUST NOT be mentioned more than one time. When multiple values are provided for a specific AfRG (either multiple values being provided or via a range of acceptable values), the responder MUST NOT provide more than one value. The Proposal MUST NOT contain any range of AfRG.</t>

<t>Upon receipt of an NO_PROPOSAL_CHOSEN Notify Payload, the initiator has the option to restart the CREATE_CHILD_SA exchange.</t>

<t>When the initiator receives the HCP_PROPOSAL_CHOSEN Notify Payload, it will evaluate the Proposal to ensure that it aligns with the initial proposal and adheres to its policies prior to executing the HCP.</t>

<figure title="The parameters for Diet-ESP have been established through the HCP_PROPOSAL_CHOSEN Notify exchange. In this instance, the responder has opted for the second Proposal, which includes the specified Attributes for Rules Generation (AfRG). Any absent AfRG will default to its predetermined values." anchor="fig-overview"><artwork align="center"><![CDATA[
Initiator                         Responder
-------------------------------------------------------------------
HDR, SA, KEi, Ni -->
                           <-- HDR, SA, KEr, Nr
HDR, SK {IDi, AUTH,
     SA, TSi, TSr,
     N(HCP_PROPOSAL
         Proposal_ID=1, HCP Name="Diet-ESP"
           AfRG_a
           ...
           AfRG_i
         ...
         Proposal_ID=2, HCP Name="Diet-ESP"
           AfRG_a
           ...
           AfRG_j)
                           <-- HDR, SK {IDr, AUTH,
                                    SA, TSi, TSr,
                                    N(HCP_PROPOSAL
                                      Proposal_ID=2, HCP Name="Diet-ESP"
                                        AfRG_a      
                                        ...
                                        AfRG_j, 
                                        AfRG_k, 
                                        ...
                                        AfRG_u)
]]></artwork></figure>

</section>
<section anchor="hcpproposal-notify-payload"><name>HCP_PROPOSAL Notify Payload</name>

<t><xref target="fig-notify"/> describes the HCP_PROPOSAL Notify Payload.</t>

<figure title="Notify Payload" anchor="fig-notify"><artwork align="center"><![CDATA[
 0 1 2 3 4 5 6 7 8 9 0 1 2 3 4 5 6 7 8 9 0 1 2 3 4 5 6 7 8 9 0 1
+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+
| Next Payload  |C|  RESERVED   |         Payload Length        |
+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+
|  Protocol ID  |   SPI Size    |      Notify Message Type      |
+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+
]]></artwork></figure>

<t>The fields Next Payload, Critical Bit, RESERVED, and Payload Length are defined in section 3.10 of <xref target="RFC7296"/>.</t>

<dl>
  <dt>Protocol ID (1 octet):</dt>
  <dd>
    <t>set to zero.</t>
  </dd>
  <dt>SPI Size (1 octet):</dt>
  <dd>
    <t>set to zero.</t>
  </dd>
  <dt>Notify Message Type (2 octets):</dt>
  <dd>
    <t>Specifies the type of notification message. It is set to TBA1 for HCP_PROPOSAL_CHOSEN.</t>
  </dd>
</dl>

<t>When sent by the Initiator, the HCP_PROPOSAL Notify Payload contains a list of Proposals described in <xref target="fig-proposal"/>. When sent by the responder the HCP_PROPOSAL Notify Payload contains a single Payload described in <xref target="fig-proposal"/>.</t>

<figure title="Proposal" anchor="fig-proposal"><artwork align="center"><![CDATA[
 0 1 2 3 4 5 6 7 8 9 0 1 2 3 4 5 6 7 8 9 0 1 2 3 4 5 6 7 8 9 0 1
+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+
|  Proposal ID  |   HCP Name   |      Proposal Length           |
+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+
|                                                               |
~                          Proposal Data                        ~
|                                                               |
+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+
]]></artwork></figure>

<dl>
  <dt>Proposal ID (1 octet):</dt>
  <dd>
    <t>The number identifying the Proposal.</t>
  </dd>
  <dt>EHCP Name (1 octet):</dt>
  <dd>
    <t>The identifier of the EHCP Name. (see <xref target="tab:hcp-name"/>)</t>
  </dd>
  <dt>Proposal Length (2 octets):</dt>
  <dd>
    <t>The length in octets  of the Proposal Data</t>
  </dd>
  <dt>Proposal Data:</dt>
  <dd>
    <t>A Proposal contains a set of parameters that are represented via Transform Attribute format <xref section="3.3.5" sectionFormat="comma" target="RFC7296"/> and detailed further as described in <xref target="sec-parameters"/>.</t>
  </dd>
</dl>

</section>
<section anchor="sec-parameters"><name>Attributes for Rules Generation</name>

<t>Attributes for Rules Generation (AfRG) follow the same format as the Transform Attribute <xref section="3.3.5" sectionFormat="comma" target="RFC7296"/> copied for convenience in <xref target="fig-attribute"/>.</t>

<figure title="Transform Attribute Payload" anchor="fig-attribute"><artwork align="center"><![CDATA[
 0 1 2 3 4 5 6 7 8 9 0 1 2 3 4 5 6 7 8 9 0 1 2 3 4 5 6 7 8 9 0 1
+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+
|A|       Attribute Type        |    AF=0  Attribute Length     |
|F|                             |    AF=1  Attribute Value      |
+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+
|                   AF=0  Attribute Data                        |
|                   AF=1  Not Transmitted                       |
+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+
]]></artwork></figure>

<t>There exist two categories of attributes: 1) generic attributes, which are applicable across all HCPs and serve to enhance the representation of a combination of AfRGs, and 2) AfRGs that are tailored to a particular HCP and possess a distinct value.</t>

<section anchor="generic-attributes"><name>Generic Attributes</name>

<t>This specification defines range_afrg_proposal as a Generic Attribute for Rules Generation to specify that a given AfRG can be selected within a range of values.</t>

<t><list style="symbols">
  <t>Designation: range_afrg_proposal</t>
  <t>Attribute Format: 0</t>
  <t>Attribute Data: Let AfRG_min and AfRG_max be the minimum and maximum values of the proposed range, expressed following the Transform Attribute Payload format. The corresponding Attribute Data is the concatenation of AfRG_min and AfRG_max.</t>
</list></t>

<t>To avoid ambiguity, it is explicitly required that both AfRG_min and AfRG_max refer to the same type of parameter and that they are processed as attributes with values defining the minimum and maximum of the range. This ensures consistent interpretation during negotiation and compression.</t>

<t>The figure below illustrates a Proposal for a compressed SPI between 6 and 8 bit long. SPI are compressed by sending LSB, so in our case AfRG_min is an esp_spi_lsb AfRG set to 6 and AfRG_max is a esp_spi_lsb set to 8.  The esp_spi_lsb AfRG is detailled in the Diet-ESP EHCP <xref target="sec-diet-esp-ehcp"/> and is a 2 byte length Attribute. The resulting range proposal i sexpressed via the combination of the range_afrg_proposal and AfRG_min and AfRG_max.</t>

<figure title="Illustration of the use of the range_afrg_proposal defining a range of SPI length" anchor="fig-range_afrg_proposal"><artwork align="center"><![CDATA[
 0 1 2 3 4 5 6 7 8 9 0 1 2 3 4 5 6 7 8 9 0 1 2 3 4 5 6 7 8 9 0 1
+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+
|0|       afrg_range_proposal    | Attribute Length = 4 octets  |
+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+
|1|           esp_spi_lsb        | Attribute Value = 6          |
+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+
|1|           esp_spi_lsb        | Attribute Value = 8          |
+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+

]]></artwork></figure>

</section>
</section>
<section anchor="sec-reg"><name>Registering a Header Compression Profile</name>

<t>An HCP needs to register an HCP Name taken from <xref target="tab:hcp-name"/> in <xref target="sec:hcp-name"/>, the specification that describes the operations of the EHCP, as well as the different AfRG. For each AfRG, the corresponding Attribute Type, the AF value, the Attribute Data or Attribute Value and the Default Value MUST be specified.</t>

</section>
<section anchor="sec-diet-esp-ehcp"><name>AfRG for the Diet-ESP HCP</name>

<t>This section defines the code points that are needed to agree on the AfRG between two IKEv2 peers as described in <xref target="sec-reg"/>.</t>

<t><list style="symbols">
  <t>HCP Name: "Diet-ESP" as specified in <xref target="tab:hcp-name"/>, <xref target="sec:hcp-name"/>.</t>
  <t>Specification : <xref target="I-D.ietf-ipsecme-diet-esp"/></t>
</list></t>

<t>The following Attributes for Rules Generation are defined:</t>

<t>DSCP Compression/Decompression Action (CDA)</t>

<t><list style="symbols">
  <t>Designation: dscp_cda</t>
  <t>Attribute Format: 1</t>
  <t>Attribute Value: DSCP CDA takes discrete values coded over one byte as described in DSCP CDA Value Registry  (<xref target="tab:dscp_cda"/> in <xref target="sec:dscp_cda"/>)</t>
  <t>Default Value: the default value is set to "uncompress"</t>
</list></t>

<t>ECN Compression/Decompression Action (CDA)</t>

<t><list style="symbols">
  <t>Designation: ecn_cda</t>
  <t>Attribute Format: 1</t>
  <t>Attribute Value: ECN CDA takes discrete values coded over one byte as described in the ECN CDA Value Registry (<xref target="tab:ecn_cda"/> in <xref target="sec:ecn_cda"/>)</t>
  <t>Default Value: the default value is set to "uncompress"</t>
</list></t>

<t>Flow Label  Compression/Decompression Action (CDA)</t>

<t><list style="symbols">
  <t>Designation: flow_label_cda</t>
  <t>Attribute Format: 1</t>
  <t>Attribute Value: Flow Label CDA takes discrete values coded over one byte as described in the Flow Label CDA Value Registry (<xref target="tab:fl_cda"/> in <xref target="sec:fl_cda"/>)</t>
  <t>Default Value: the default value is set to "uncompress"</t>
</list></t>

<t>OS or Network Bit Alignment</t>

<t><list style="symbols">
  <t>Designation: alignment</t>
  <t>Attribute Format: 1</t>
  <t>Attribute Value: Byte Alignment takes discrete values coded over one byte as described in the Bit Alignment Value Registry (<xref target="tab:align"/> in <xref target="sec:align"/>)</t>
  <t>Default Value: the default value is set to "64 bit", which corresponds to the standard IPv6 bit alignment. The default value of 64 bit in this specification refers to the bit alignment used for Diet-ESP compression operations and does not override or contradict the alignment requirements of RFC 4303. Instead, the alignment specified here ensures compatibility with the SCHC compression framework, which is designed to operate efficiently in constrained networks.</t>
</list></t>

<t>Security Parameter Index (SPI) Least Significant Bits (LSB)</t>

<t><list style="symbols">
  <t>Designation: esp_spi_lsb</t>
  <t>Attribute Format: 1</t>
  <t>Attribute Value: SPI LSB designates the number of bits that are provided to infer the SPI. This number is between 0 and 32.</t>
  <t>Default Value: the default value is 32, which is the size of the standard SPI in the standard ESP</t>
</list></t>

<t>Sequence Number (SN) Least Significant Bits (LSB)</t>

<t><list style="symbols">
  <t>Designation: esp_sn_lsb</t>
  <t>Attribute Format: 1</t>
  <t>Attribute Value: SN LSB designates the number of bits that are provided to infer the SPI. This number is between 0 and 32.</t>
  <t>Default Value: the default value is 32, which is the size of the standard SN in the standard ESP</t>
</list></t>

</section>
<section anchor="iana-considerations"><name>IANA Considerations</name>

<section anchor="registration-of-ikev2-notify-message-types"><name>Registration of IKEv2 Notify Message Types</name>

<t>IANA has allocated two values in the "IKEv2 Notify Message Types - Status Types" registry:</t>

<figure><artwork><![CDATA[
  Value    Notify Messages - Status Types
-----------------------------------------
  TBA1    HCP_PROPOSAL
]]></artwork></figure>

<t>This specification requests the IANA to create a  Header Compression Profile registry (see <xref target="sec:hcp-name"/>), as well as the necessary registries for the ESP Header Compression Profile Diet-ESP, that is the Attribute for Rules Generations (see <xref target="sec:afrg"/>) as well as, when required, the complementary specific AfRG Values associated with each AfRG (see <xref target="sec:afrg-val"/>).</t>

<t>Note that the term "Header Compression Profile" reflects the purpose of the registry, which is to define profiles for ESP header compression using the Diet-ESP methodology. While the registry is managed and utilized exclusively by IKEv2 for negotiating compression parameters, its scope is limited to ESP header compression and does not extend to IKEv2 itself.</t>

<t>All registries are "Specification Required".</t>

</section>
<section anchor="sec:gen-afrg"><name>Registry for Generic Attributes for Rules Generation</name>

<t>Registry for Generic Attributes for Rules Generation. When Associated Data is set to YES, the AF bit of the corresponding Transform Attribute Payload is set to 0; otherwise it is set to 1. The AfRG Code Point mentioned here MUST NOT be reused by any Registries associated with any Profile and is shared by all profiles.</t>

<texttable anchor="tab:gen-afrg">
      <ttcol align='left'>AfRG Code Point</ttcol>
      <ttcol align='left'>Full Name</ttcol>
      <ttcol align='left'>Designation</ttcol>
      <ttcol align='left'>Attribute Format</ttcol>
      <ttcol align='left'>Reference</ttcol>
      <c>65535</c>
      <c>RANGE AfRG</c>
      <c>range_afrg_proposal</c>
      <c>0</c>
      <c>ThisRFC</c>
</texttable>

<t>Each entry in the range is represented by two attributes (AfRG_min and AfRG_max), both following the 2-byte Attribute Type format specified in <xref target="RFC7296"/>. This ensures clarity and compatibility in all implementations.</t>

</section>
<section anchor="sec:hcp-name"><name>Registry for IKEv2 Header Compression Profile</name>

<texttable anchor="tab:hcp-name">
      <ttcol align='left'>Value (1 Byte)</ttcol>
      <ttcol align='left'>Designation</ttcol>
      <ttcol align='left'>Reference</ttcol>
      <c>0</c>
      <c>Diet-ESP</c>
      <c>ThisRFC</c>
      <c>1-255</c>
      <c>unallocated</c>
      <c>-</c>
</texttable>

</section>
<section anchor="sec:afrg"><name>Registry for Diet-ESP Attributes for Rules Generation</name>

<t>Registry for Attributes for Rules Generation for the ESP Header Compression Profile Diet-ESP. When Associated Data is set to YES, the AF bit of the corresponding Transform Attribute Payload is set to 0; otherwise it is set to 1.</t>

<t>The Diet-ESP Attributes for Rules Generation registry specifies six AfRG parameters explicitly defined for Diet-ESP that are not part of the standard IKEv2 negotiation process. These attributes are required for implementing the Diet-ESP Header Compression Profile. The remaining attributes referenced in <xref target="RFC7296"/>, <xref target="RFC4301"/>, and related drafts (e.g., DSCP values) are already defined and negotiated during the creation of the CHILD SA.</t>

<texttable anchor="tab:afrg">
      <ttcol align='left'>AfRG Code Point</ttcol>
      <ttcol align='left'>Full Name</ttcol>
      <ttcol align='left'>Designation</ttcol>
      <ttcol align='left'>Attribute Format</ttcol>
      <ttcol align='left'>Reference</ttcol>
      <c>0</c>
      <c>DSCP CDA</c>
      <c>dscp_cda</c>
      <c>1</c>
      <c>ThisRFC</c>
      <c>1</c>
      <c>ECN CDA</c>
      <c>ecn_cda</c>
      <c>1</c>
      <c>ThisRFC</c>
      <c>2</c>
      <c>Flow Label CDA</c>
      <c>flow_label_cda</c>
      <c>1</c>
      <c>ThisRFC</c>
      <c>3</c>
      <c>Alignment</c>
      <c>alignment</c>
      <c>1</c>
      <c>ThisRFC</c>
      <c>4</c>
      <c>SPI LSB</c>
      <c>esp_spi_lsb</c>
      <c>1</c>
      <c>ThisRFC</c>
      <c>5</c>
      <c>SN  LSB</c>
      <c>esp_spi_sn</c>
      <c>1</c>
      <c>ThisRFC</c>
      <c>6 - 2^16-2</c>
      <c>unallocated</c>
      <c>-</c>
      <c>-</c>
      <c>-</c>
</texttable>

</section>
<section anchor="sec:afrg-val"><name>Registries for the Values of Diet-ESP Attributes for Rules Generation</name>

<section anchor="sec:dscp_cda"><name>DSCP CDA Value Registry</name>

<texttable anchor="tab:dscp_cda">
      <ttcol align='left'>Value</ttcol>
      <ttcol align='left'>Designation</ttcol>
      <ttcol align='left'>Reference</ttcol>
      <c>0</c>
      <c>uncompress</c>
      <c>ThisRFC</c>
      <c>1</c>
      <c>lower</c>
      <c>ThisRFC</c>
      <c>2</c>
      <c>sa</c>
      <c>ThisRFC</c>
      <c>3-255</c>
      <c>unallocated</c>
      <c>-</c>
</texttable>

</section>
<section anchor="sec:ecn_cda"><name>ECN CDA Value Registry</name>

<texttable anchor="tab:ecn_cda">
      <ttcol align='left'>Value</ttcol>
      <ttcol align='left'>Designation</ttcol>
      <ttcol align='left'>Reference</ttcol>
      <c>0</c>
      <c>uncompress</c>
      <c>ThisRFC</c>
      <c>1</c>
      <c>lower</c>
      <c>ThisRFC</c>
      <c>2-255</c>
      <c>unallocated</c>
      <c>-</c>
</texttable>

</section>
<section anchor="sec:fl_cda"><name>Flow Label CDA Value Registry</name>

<texttable anchor="tab:fl_cda">
      <ttcol align='left'>Value</ttcol>
      <ttcol align='left'>Designation</ttcol>
      <ttcol align='left'>Reference</ttcol>
      <c>0</c>
      <c>uncompress</c>
      <c>ThisRFC</c>
      <c>1</c>
      <c>lower</c>
      <c>ThisRFC</c>
      <c>2</c>
      <c>generated</c>
      <c>ThisRFC</c>
      <c>3</c>
      <c>zero</c>
      <c>ThisRFC</c>
      <c>4-255</c>
      <c>unallocated</c>
      <c>-</c>
</texttable>

</section>
<section anchor="sec:align"><name>OS or Network Byte Alignment</name>

<texttable anchor="tab:align">
      <ttcol align='left'>Value</ttcol>
      <ttcol align='left'>Designation</ttcol>
      <ttcol align='left'>Reference</ttcol>
      <c>0</c>
      <c>8 bit</c>
      <c>ThisRFC</c>
      <c>1</c>
      <c>16 bit</c>
      <c>ThisRFC</c>
      <c>2</c>
      <c>32 bit</c>
      <c>ThisRFC</c>
      <c>3</c>
      <c>64 bit</c>
      <c>ThisRFC</c>
      <c>4-255</c>
      <c>unallocated</c>
      <c>-</c>
</texttable>

</section>
</section>
</section>
<section anchor="security-considerations"><name>Security Considerations</name>

<t>The protocol defined in this document does not modify IKEv2.</t>

<t>Proposals may be expressed in various ways and a proposal may be expressed in a specific way so that its treatment overloads the receiver. The receiver needs to consider aborting the exchange when too much resource is required.</t>

</section>


  </middle>

  <back>


    <references title='Normative References' anchor="sec-normative-references">

&RFC2119;
&RFC8174;
&I-D.ietf-ipsecme-diet-esp;
&RFC7296;
&RFC4301;


    </references>




  </back>

<!-- ##markdown-source:
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
it8QTAAA

-->

</rfc>

