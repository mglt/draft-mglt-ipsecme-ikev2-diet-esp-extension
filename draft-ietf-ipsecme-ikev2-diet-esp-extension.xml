<?xml version="1.0" encoding="UTF-8"?>
  <?xml-stylesheet type="text/xsl" href="rfc2629.xslt" ?>
  <!-- generated by https://github.com/cabo/kramdown-rfc version 1.7.22 (Ruby 3.0.2) -->


<!DOCTYPE rfc  [
  <!ENTITY nbsp    "&#160;">
  <!ENTITY zwsp   "&#8203;">
  <!ENTITY nbhy   "&#8209;">
  <!ENTITY wj     "&#8288;">

<!ENTITY RFC2119 SYSTEM "https://bib.ietf.org/public/rfc/bibxml/reference.RFC.2119.xml">
<!ENTITY RFC8174 SYSTEM "https://bib.ietf.org/public/rfc/bibxml/reference.RFC.8174.xml">
<!ENTITY I-D.ietf-ipsecme-diet-esp SYSTEM "https://bib.ietf.org/public/rfc/bibxml3/reference.I-D.ietf-ipsecme-diet-esp.xml">
<!ENTITY RFC7296 SYSTEM "https://bib.ietf.org/public/rfc/bibxml/reference.RFC.7296.xml">
<!ENTITY RFC4301 SYSTEM "https://bib.ietf.org/public/rfc/bibxml/reference.RFC.4301.xml">
]>


<rfc ipr="trust200902" docName="draft-ietf-ipsecme-ikev2-diet-esp-extension-04" category="std" consensus="true" submissionType="IETF" tocInclude="true" sortRefs="true" symRefs="true">
  <front>
    <title abbrev="EHC extension">Internet Key Exchange version 2 (IKEv2) extension for Header Compression Profile (HCP)</title>

    <author initials="D." surname="Migault" fullname="Daniel Migault">
      <organization>Ericsson</organization>
      <address>
        <email>daniel.migault@ericsson.com</email>
      </address>
    </author>
    <author initials="M." surname="Hatami" fullname="Maryam Hatami">
      <organization>Concordia University</organization>
      <address>
        <email>maryam.hatami@mail.concordia.ca</email>
      </address>
    </author>
    <author initials="D." surname="Liu" fullname="Daiying Liu">
      <organization>Ericsson</organization>
      <address>
        <email>harold.liu@ericsson.com</email>
      </address>
    </author>
    <author initials="S." surname="Preda" fullname="Stere Preda">
      <organization>Ericsson</organization>
      <address>
        <email>stere.preda@ericsson.com</email>
      </address>
    </author>
    <author initials="W." surname="Atwood" fullname="J. William Atwood">
      <organization>Concordia University</organization>
      <address>
        <email>william.atwood@concordia.ca</email>
      </address>
    </author>
    <author initials="S." surname="Céspedes" fullname="Sandra Céspedes">
      <organization>Concordia University</organization>
      <address>
        <email>sandra.cespedes@concordia.ca</email>
      </address>
    </author>
    <author initials="T." surname="Guggemos" fullname="Tobias Guggemos">
      <organization>LMU</organization>
      <address>
        <email>guggemos@nm.ifi.lmu.de</email>
      </address>
    </author>
    <author initials="D." surname="Schinazi" fullname="David Schinazi">
      <organization>Google LLC</organization>
      <address>
        <email>dschinazi.ietf@gmail.com</email>
      </address>
    </author>

    <date year="2025" month="March" day="03"/>

    <area>Security</area>
    <workgroup>IPsecme</workgroup>
    <keyword>Internet-Draft</keyword>

    <abstract>


<?line 61?>

<t>This document describes an IKEv2 extension for Header Compression to agree on Attributes for Rules Generation. 
This extension defines the necessary registries for the ESP Header Compression Profile (EHCP) Diet-ESP.</t>



    </abstract>



  </front>

  <middle>


<?line 66?>

<section anchor="requirements-notation"><name>Requirements notation</name>

<t>The key words "MUST", "MUST NOT", "REQUIRED", "SHALL", "SHALL
NOT", "SHOULD", "SHOULD NOT", "RECOMMENDED", "NOT RECOMMENDED",
"MAY", and "OPTIONAL" in this document are to be interpreted as
described in BCP 14 <xref target="RFC2119"/> <xref target="RFC8174"/> when, and only when, they
appear in all capitals, as shown here.
<?line -6?></t>

</section>
<section anchor="introduction"><name>Introduction</name>

<t>The ESP Header Compression Profile (EHCP) <xref target="I-D.ietf-ipsecme-diet-esp"/> minimizes the overhead associated with ESP by compressing both the ESP header and additional fields within the secured packet. EHCP utilizes Attributes for Rules Generation (AfRG) that are specified for each Security Association (SA). Certain AfRG have already been established during the SA negotiation process through IKEv2. This extension facilitates the agreement on the remaining AfRG through IKEv2.</t>

</section>
<section anchor="protocol-overview"><name>Protocol Overview</name>

<t>As illustrated in <xref target="fig-overview"/>, an initiator intending to utilize the Header Compression Profile (HCP) informs its peer by sending a HCP_PROPOSAL Notify Payload during the IKE_AUTH and CREATE_CHILD_SA exchanges. The HCP_PROPOSAL includes a list of Proposals, each comprising an EHCP Name along with a set of Attributes for Rules Generation (AfRG)<xref target="I-D.ietf-ipsecme-diet-esp"/>. Any AfRG for which the initiator wishes to specify no limitations SHOULD be excluded, i.e., an AfRG is only sent if the sending peer wants the receiving peer to select a subset of the available values. A given AfRG MAY be repeated with different values in order to provide a list of acceptable values. A range of possible AfRG values MAY be indicated as well.</t>

<t>If a Proposal contains an unknown HCP Name, or any AfRG in a Proposal is unknown, then the entire Proposal must be discarded by the responder. If none of the received Proposals are deemed acceptable, the responder MAY choose to discard the HCP_PROPOSAL Notify Payload. Nevertheless, it is anticipated that the responder will provide an explanation for rejecting all HCP Proposals. If the reason pertains to an AfRG with an unacceptable value, the responder SHOULD reply with a NO_PROPOSAL_CHOSEN Notify Payload.</t>

<t>Conversely, if the receiver identifies a suitable Proposal, it will respond with an HCP_PROPOSAL Notify Payload that includes the chosen Proposal. In cases where the AfRG was not explicitly stated, the responder will provide the AfRG unless it defaults to a standard value. Each AfRG MUST NOT be mentioned more than one time. When multiple values are provided for a specific AfRG (either multiple values being provided or via a range of acceptable values), the responder MUST NOT provide more than one value. The Proposal MUST NOT contain any range of AfRG.</t>

<t>Upon receipt of an NO_PROPOSAL_CHOSEN Notify Payload, the initiator has the option to restart the CREATE_CHILD_SA exchange.</t>

<t>When the initiator receives the HCP_PROPOSAL_CHOSEN Notify Payload, it will evaluate the Proposal to ensure that it aligns with the initial proposal and adheres to its policies prior to executing the HCP.</t>

<figure title="The parameters for Diet-ESP have been established through the HCP_PROPOSAL_CHOSEN Notify exchange. In this instance, the responder has opted for the second Proposal, which includes the specified Attributes for Rules Generation (AfRG). Any absent AfRG will default to its predetermined values." anchor="fig-overview"><artwork align="center"><![CDATA[
Initiator                         Responder
-------------------------------------------------------------------
HDR, SA, KEi, Ni -->
                           <-- HDR, SA, KEr, Nr
HDR, SK {IDi, AUTH,
     SA, TSi, TSr,
     N(HCP_PROPOSAL
         Proposal_ID=1, HCP Name="Diet-ESP"
           AfRG_a
           ...
           AfRG_i
         ...
         Proposal_ID=2, HCP Name="Diet-ESP"
           AfRG_a
           ...
           AfRG_j)
                           <-- HDR, SK {IDr, AUTH,
                                    SA, TSi, TSr,
                                    N(HCP_PROPOSAL
                                      Proposal_ID=2, HCP Name="Diet-ESP"
                                        AfRG_a      
                                        ...
                                        AfRG_j, 
                                        AfRG_k, 
                                        ...
                                        AfRG_u)
]]></artwork></figure>

</section>
<section anchor="hcpproposal-notify-payload"><name>HCP_PROPOSAL Notify Payload</name>

<t><xref target="fig-notify"/> describes the HCP_PROPOSAL Notify Payload.</t>

<figure title="Notify Payload" anchor="fig-notify"><artwork align="center"><![CDATA[
 0 1 2 3 4 5 6 7 8 9 0 1 2 3 4 5 6 7 8 9 0 1 2 3 4 5 6 7 8 9 0 1
+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+
| Next Payload  |C|  RESERVED   |         Payload Length        |
+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+
|  Protocol ID  |   SPI Size    |      Notify Message Type      |
+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+
]]></artwork></figure>

<t>The fields Next Payload, Critical Bit, RESERVED, and Payload Length are defined in section 3.10 of <xref target="RFC7296"/>.</t>

<dl>
  <dt>Protocol ID (1 octet):</dt>
  <dd>
    <t>set to zero.</t>
  </dd>
  <dt>SPI Size (1 octet):</dt>
  <dd>
    <t>set to zero.</t>
  </dd>
  <dt>Notify Message Type (2 octets):</dt>
  <dd>
    <t>Specifies the type of notification message. It is set to TBA1 for HCP_PROPOSAL_CHOSEN.</t>
  </dd>
</dl>

<t>When sent by the Initiator, the HCP_PROPOSAL Notify Payload contains a list of Proposals described in <xref target="fig-proposal"/>. When sent by the responder the HCP_PROPOSAL Notify Payload contains a single Payload described in <xref target="fig-proposal"/>.</t>

<figure title="Proposal" anchor="fig-proposal"><artwork align="center"><![CDATA[
 0 1 2 3 4 5 6 7 8 9 0 1 2 3 4 5 6 7 8 9 0 1 2 3 4 5 6 7 8 9 0 1
+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+
|  Proposal ID  |   HCP Name   |      Proposal Length           |
+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+
|                                                               |
~                          Proposal Data                        ~
|                                                               |
+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+
]]></artwork></figure>

<dl>
  <dt>Proposal ID (1 octet):</dt>
  <dd>
    <t>The number identifying the Proposal.</t>
  </dd>
  <dt>EHCP Name (1 octet):</dt>
  <dd>
    <t>The identifier of the EHCP Name. (see <xref target="tab:hcp-name"/>)</t>
  </dd>
  <dt>Proposal Length (2 octets):</dt>
  <dd>
    <t>The length in octets  of the Proposal Data</t>
  </dd>
  <dt>Proposal Data:</dt>
  <dd>
    <t>A Proposal contains a set of parameters that are represented via Transform Attribute format <xref section="3.3.5" sectionFormat="comma" target="RFC7296"/> and detailed further as described in <xref target="sec-parameters"/>.</t>
  </dd>
</dl>

</section>
<section anchor="sec-parameters"><name>Attributes for Rules Generation</name>

<t>Attributes for Rules Generation (AfRG) follow the same format as the Transform Attribute <xref section="3.3.5" sectionFormat="comma" target="RFC7296"/> copied for convenience in <xref target="fig-attribute"/>.</t>

<figure title="Transform Attribute Payload" anchor="fig-attribute"><artwork align="center"><![CDATA[
 0 1 2 3 4 5 6 7 8 9 0 1 2 3 4 5 6 7 8 9 0 1 2 3 4 5 6 7 8 9 0 1
+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+
|A|       Attribute Type        |    AF=0  Attribute Length     |
|F|                             |    AF=1  Attribute Value      |
+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+
|                   AF=0  Attribute Data                        |
|                   AF=1  Not Transmitted                       |
+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+
]]></artwork></figure>

<t>There exist two categories of attributes: 1) generic attributes, which are applicable across all HCPs and serve to enhance the representation of a combination of AfRGs, and 2) AfRGs that are tailored to a particular HCP and possess a distinct value.</t>

<section anchor="generic-attributes"><name>Generic Attributes</name>

<t>This specification defines range_afrg_proposal as a Generic Attribute for Rules Generation to specify that a given AfRG can be selected within a range of values.</t>

<t><list style="symbols">
  <t>Designation: range_afrg_proposal</t>
  <t>Attribute Format: 0</t>
  <t>Attribute Data: Let AfRG_min and AfRG_max be the minimum and maximum values of the proposed range, expressed following the Transform Attribute Payload format. The corresponding Attribute Data is the concatenation of AfRG_min and AfRG_max.</t>
</list></t>

<t>To avoid ambiguity, it is explicitly required that both AfRG_min and AfRG_max refer to the same type of parameter and that they are processed as attributes with values defining the minimum and maximum of the range. This ensures consistent interpretation during negotiation and compression.</t>

<t>The figure below illustrates a Proposal for a compressed SPI between 6 and 8 bit long. SPI are compressed by sending LSB, so in our case AfRG_min is an esp_spi_lsb AfRG set to 6 and AfRG_max is a esp_spi_lsb set to 8.  The esp_spi_lsb AfRG is detailed in the Diet-ESP EHCP <xref target="sec-diet-esp-ehcp"/> and is a 2 byte length Attribute. The resulting range proposal is expressed via the combination of the range_afrg_proposal and AfRG_min and AfRG_max.</t>

<figure title="Illustration of the use of the range_afrg_proposal defining a range of SPI length" anchor="fig-range_afrg_proposal"><artwork align="center"><![CDATA[
 0 1 2 3 4 5 6 7 8 9 0 1 2 3 4 5 6 7 8 9 0 1 2 3 4 5 6 7 8 9 0 1
+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+
|0|       afrg_range_proposal    | Attribute Length = 4 octets  |
+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+
|1|           esp_spi_lsb        | Attribute Value = 6          |
+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+
|1|           esp_spi_lsb        | Attribute Value = 8          |
+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+

]]></artwork></figure>

</section>
</section>
<section anchor="sec-reg"><name>Registering a Header Compression Profile</name>

<t>An HCP needs to register an HCP Name taken from <xref target="tab:hcp-name"/> in <xref target="sec:hcp-name"/>, the specification that describes the operations of the EHCP, as well as the different AfRG. For each AfRG, the corresponding Attribute Type, the AF value, the Attribute Data or Attribute Value and the Default Value MUST be specified.</t>

</section>
<section anchor="sec-diet-esp-ehcp"><name>AfRG for the Diet-ESP HCP</name>

<t>This section defines the code points that are needed to agree on the AfRG between two IKEv2 peers as described in <xref target="sec-reg"/>.</t>

<t><list style="symbols">
  <t>HCP Name: "Diet-ESP" as specified in <xref target="tab:hcp-name"/>, <xref target="sec:hcp-name"/>.</t>
  <t>Specification : <xref target="I-D.ietf-ipsecme-diet-esp"/></t>
</list></t>

<t>The following Attributes for Rules Generation are defined:</t>

<t>DSCP Compression/Decompression Action (CDA)</t>

<t><list style="symbols">
  <t>Designation: dscp_cda</t>
  <t>Attribute Format: 1</t>
  <t>Attribute Value: DSCP CDA takes discrete values coded over one byte as described in DSCP CDA Value Registry  (<xref target="tab:dscp_cda"/> in <xref target="sec:dscp_cda"/>)</t>
  <t>Default Value: the default value is set to "not_compressed"</t>
</list></t>

<t>ECN Compression/Decompression Action (CDA)</t>

<t><list style="symbols">
  <t>Designation: ecn_cda</t>
  <t>Attribute Format: 1</t>
  <t>Attribute Value: ECN CDA takes discrete values coded over one byte as described in the ECN CDA Value Registry (<xref target="tab:ecn_cda"/> in <xref target="sec:ecn_cda"/>)</t>
  <t>Default Value: the default value is set to "not_compressed"</t>
</list></t>

<t>Flow Label  Compression/Decompression Action (CDA)</t>

<t><list style="symbols">
  <t>Designation: flow_label_cda</t>
  <t>Attribute Format: 1</t>
  <t>Attribute Value: Flow Label CDA takes discrete values coded over one byte as described in the Flow Label CDA Value Registry (<xref target="tab:fl_cda"/> in <xref target="sec:fl_cda"/>)</t>
  <t>Default Value: the default value is set to "not_compressed"</t>
</list></t>

<t>ESP Byte Alignment</t>

<t><list style="symbols">
  <t>Designation: alignment</t>
  <t>Attribute Format: 1</t>
  <t>Attribute Value: Byte Alignment takes discrete values coded over one byte as described in the Bit Alignment Value Registry (<xref target="tab:align"/> in <xref target="sec:align"/>)</t>
  <t>Default Value: the default value is set to "64 bit", which corresponds to the standard IPv6 bit alignment. The default value of 64 bit in this specification refers to the bit alignment used for Diet-ESP compression operations and does not override or contradict the alignment requirements of RFC 4303. Instead, the alignment specified here ensures compatibility with the SCHC compression framework, which is designed to operate efficiently in constrained networks.</t>
</list></t>

<t>ESP Trailer</t>

<t><list style="symbols">
  <t>Designation: esp_trailer</t>
  <t>Attribute Format: 1</t>
  <t>Attribute Value: ESP Trailer takes discrete values coded over one byte as described in the Bit Alignment Value Registry (<xref target="tab:esp_trailer"/> in <xref target="sec:esp_trailer"/>)</t>
  <t>Default Value: the default value is set to "Optional", which enable the ESP Trailer to be compressed.</t>
</list></t>

<t>Security Parameter Index (SPI) Least Significant Bits (LSB)</t>

<t><list style="symbols">
  <t>Designation: esp_spi_lsb</t>
  <t>Attribute Format: 1</t>
  <t>Attribute Value: SPI LSB designates the number of bits that are provided to infer the SPI. This number is between 0 and 32.</t>
  <t>Default Value: the default value is 32, which is the size of the standard SPI in the standard ESP</t>
</list></t>

<t>Sequence Number (SN) Least Significant Bits (LSB)</t>

<t><list style="symbols">
  <t>Designation: esp_sn_lsb</t>
  <t>Attribute Format: 1</t>
  <t>Attribute Value: SN LSB designates the number of bits that are provided to infer the SPI. This number is between 0 and 32.</t>
  <t>Default Value: the default value is 32, which is the size of the standard SN in the standard ESP</t>
</list></t>

</section>
<section anchor="iana-considerations"><name>IANA Considerations</name>

<section anchor="registration-of-ikev2-notify-message-types"><name>Registration of IKEv2 Notify Message Types</name>

<t>IANA has allocated one value in the "IKEv2 Notify Message Types - Status Types" registry:</t>

<figure><artwork><![CDATA[
  Value    Notify Messages - Status Types
-----------------------------------------
  TBA1    HCP_PROPOSAL
]]></artwork></figure>

<t>This specification requests the IANA to create a  Header Compression Profile registry (see <xref target="sec:hcp-name"/>), as well as the necessary registries for the ESP Header Compression Profile Diet-ESP, that is the Attribute for Rules Generations (see <xref target="sec:afrg"/>) as well as, when required, the complementary specific AfRG Values associated with each AfRG (see <xref target="sec:afrg-val"/>).</t>

<t>Note that the term "Header Compression Profile" reflects the purpose of the registry, which is to define profiles for ESP header compression using the Diet-ESP methodology. While the registry is managed and utilized exclusively by IKEv2 for negotiating compression parameters, its scope is limited to ESP header compression and does not extend to IKEv2 itself.</t>

<t>All registries are "Specification Required".</t>

</section>
<section anchor="sec:gen-afrg"><name>Registry for Generic Attributes for Rules Generation</name>

<t>Registry for Generic Attributes for Rules Generation. When Associated Data is set to YES, the AF bit of the corresponding Transform Attribute Payload is set to 0; otherwise it is set to 1. The AfRG Code Point mentioned here MUST NOT be reused by any Registries associated with any Profile and is shared by all profiles.</t>

<texttable anchor="tab:gen-afrg">
      <ttcol align='left'>AfRG Code Point</ttcol>
      <ttcol align='left'>Full Name</ttcol>
      <ttcol align='left'>Designation</ttcol>
      <ttcol align='left'>Attribute Format</ttcol>
      <ttcol align='left'>Reference</ttcol>
      <c>65535</c>
      <c>RANGE AfRG</c>
      <c>range_afrg_proposal</c>
      <c>0</c>
      <c>ThisRFC</c>
</texttable>

<t>Each entry in the range is represented by two attributes (AfRG_min and AfRG_max), both following the 2-byte Attribute Type format specified in <xref target="RFC7296"/>. This ensures clarity and compatibility in all implementations.</t>

</section>
<section anchor="sec:hcp-name"><name>Registry for IKEv2 Header Compression Profile</name>

<texttable anchor="tab:hcp-name">
      <ttcol align='left'>Value (1 Byte)</ttcol>
      <ttcol align='left'>Designation</ttcol>
      <ttcol align='left'>Reference</ttcol>
      <c>0</c>
      <c>Diet-ESP</c>
      <c>ThisRFC</c>
      <c>1-255</c>
      <c>unallocated</c>
      <c>-</c>
</texttable>

</section>
<section anchor="sec:afrg"><name>Registry for Diet-ESP Attributes for Rules Generation</name>

<t>Registry for Attributes for Rules Generation for the ESP Header Compression Profile Diet-ESP. When Associated Data is set to YES, the AF bit of the corresponding Transform Attribute Payload is set to 0; otherwise it is set to 1.</t>

<t>The Diet-ESP Attributes for Rules Generation registry specifies six AfRG parameters explicitly defined for Diet-ESP that are not part of the standard IKEv2 negotiation process. These attributes are required for implementing the Diet-ESP Header Compression Profile. The remaining attributes referenced in <xref target="RFC7296"/>, <xref target="RFC4301"/>, and related drafts (e.g., DSCP values) are already defined and negotiated during the creation of the CHILD SA.</t>

<texttable anchor="tab:afrg">
      <ttcol align='left'>AfRG Code Point</ttcol>
      <ttcol align='left'>Full Name</ttcol>
      <ttcol align='left'>Designation</ttcol>
      <ttcol align='left'>Attribute Format</ttcol>
      <ttcol align='left'>Reference</ttcol>
      <c>0</c>
      <c>DSCP CDA</c>
      <c>dscp_cda</c>
      <c>1</c>
      <c>ThisRFC</c>
      <c>1</c>
      <c>ECN CDA</c>
      <c>ecn_cda</c>
      <c>1</c>
      <c>ThisRFC</c>
      <c>2</c>
      <c>Flow Label CDA</c>
      <c>flow_label_cda</c>
      <c>1</c>
      <c>ThisRFC</c>
      <c>3</c>
      <c>Alignment</c>
      <c>alignment</c>
      <c>1</c>
      <c>ThisRFC</c>
      <c>4</c>
      <c>SPI LSB</c>
      <c>esp_spi_lsb</c>
      <c>1</c>
      <c>ThisRFC</c>
      <c>5</c>
      <c>SN  LSB</c>
      <c>esp_spi_sn</c>
      <c>1</c>
      <c>ThisRFC</c>
      <c>6 - 2^16-2</c>
      <c>unallocated</c>
      <c>-</c>
      <c>-</c>
      <c>-</c>
</texttable>

</section>
<section anchor="sec:afrg-val"><name>Registries for the Values of Diet-ESP Attributes for Rules Generation</name>

<section anchor="sec:dscp_cda"><name>DSCP CDA Value Registry</name>

<texttable anchor="tab:dscp_cda">
      <ttcol align='left'>Value</ttcol>
      <ttcol align='left'>Designation</ttcol>
      <ttcol align='left'>Reference</ttcol>
      <c>0</c>
      <c>not_compressed</c>
      <c>ThisRFC</c>
      <c>1</c>
      <c>lower</c>
      <c>ThisRFC</c>
      <c>2</c>
      <c>sa</c>
      <c>ThisRFC</c>
      <c>3-255</c>
      <c>unallocated</c>
      <c>-</c>
</texttable>

</section>
<section anchor="sec:ecn_cda"><name>ECN CDA Value Registry</name>

<texttable anchor="tab:ecn_cda">
      <ttcol align='left'>Value</ttcol>
      <ttcol align='left'>Designation</ttcol>
      <ttcol align='left'>Reference</ttcol>
      <c>0</c>
      <c>not_compressed</c>
      <c>ThisRFC</c>
      <c>1</c>
      <c>lower</c>
      <c>ThisRFC</c>
      <c>2-255</c>
      <c>unallocated</c>
      <c>-</c>
</texttable>

</section>
<section anchor="sec:fl_cda"><name>Flow Label CDA Value Registry</name>

<texttable anchor="tab:fl_cda">
      <ttcol align='left'>Value</ttcol>
      <ttcol align='left'>Designation</ttcol>
      <ttcol align='left'>Reference</ttcol>
      <c>0</c>
      <c>not_compressed</c>
      <c>ThisRFC</c>
      <c>1</c>
      <c>lower</c>
      <c>ThisRFC</c>
      <c>2</c>
      <c>generated</c>
      <c>ThisRFC</c>
      <c>3</c>
      <c>zero</c>
      <c>ThisRFC</c>
      <c>4-255</c>
      <c>unallocated</c>
      <c>-</c>
</texttable>

</section>
<section anchor="sec:align"><name>ESP Byte Alignment</name>

<texttable anchor="tab:align">
      <ttcol align='left'>Value</ttcol>
      <ttcol align='left'>Designation</ttcol>
      <ttcol align='left'>Reference</ttcol>
      <c>0</c>
      <c>8 bit</c>
      <c>ThisRFC</c>
      <c>1</c>
      <c>16 bit</c>
      <c>ThisRFC</c>
      <c>2</c>
      <c>32 bit</c>
      <c>ThisRFC</c>
      <c>3</c>
      <c>64 bit</c>
      <c>ThisRFC</c>
      <c>4-255</c>
      <c>unallocated</c>
      <c>-</c>
</texttable>

</section>
</section>
<section anchor="sec:esp_trailer"><name>ESP Trailer</name>

<texttable anchor="tab:esp_trailer">
      <ttcol align='left'>Value</ttcol>
      <ttcol align='left'>Designation</ttcol>
      <ttcol align='left'>Reference</ttcol>
      <c>0</c>
      <c>Mandatory</c>
      <c>ThisRFC</c>
      <c>1</c>
      <c>Optional</c>
      <c>ThisRFC</c>
      <c>2-255</c>
      <c>unallocated</c>
      <c>-</c>
</texttable>

</section>
</section>
<section anchor="security-considerations"><name>Security Considerations</name>

<t>The protocol defined in this document does not modify IKEv2.</t>

<t>Proposals may be expressed in various ways and a proposal may be expressed in a specific way so that its treatment overloads the receiver. The receiver needs to consider aborting the exchange when too much resource is required.</t>

</section>
<section anchor="acknowledgements"><name>Acknowledgements</name>

<t>The authors extend their gratitude to Samita Chakrabart, Tero Kivinen, Michael Richarson and Valery Smyslov for their long time support. The authors would like to acknowledge the support from Mitacs through the Mitacs Accelerate program.</t>

</section>


  </middle>

  <back>



    <references title='Normative References' anchor="sec-normative-references">

&RFC2119;
&RFC8174;
&I-D.ietf-ipsecme-diet-esp;
&RFC7296;
&RFC4301;


    </references>





  </back>

<!-- ##markdown-source:
H4sIAAAAAAAAA9U8XXfbuHLv/BWo82K3EmvJiTfr3ty7iu3EbvxVy9k996U+
EAlJWFOkLkHa0cbJb+lr/0b7xzoz+CBIypKdeHt2tedsLBAYzAzme0B1u92g
kEUi9thxWog8FQX7IBbs8FM05elEsFuRK5mlrM82jz8c3va3mPhUiJTGxlnO
jgSPRc72s9k8F4qGL/JsLBPBNo/2L7ZYwEejXNzuscOj/WptEGdRymewbZzz
cdGVohh35VyJaCa68kbc9rsxjHWFmnfdou72y0DO8z1W5KUq+tvbP273A54L
vseGIipzWSyCuwlQckFwgpu7iqruAe4TRLzYY6qIA1XAuhk8P7x6FwRzuRcw
VmTRHlsIBX+qLIcJY+W+L2bV14CXxTTLcQljXfo/YzKFpwchO5UTXiaFGdU0
HvBUiqTxKMsB1cNcRkoBP/SYmHGZAE9ofjjT838SZlIYZbP2nqchO+IFn8na
lqc8X/BZ/QntuJ+lUZbHkrOPqaTTBa7Vdp/R0nBKS3/CMdjYLAojvpTqE1k2
KJYLmU688RXkTnmeJXGYyHINqcMQhEvEvLbVEA5Y1MZXbKVwcjjHyWv2+iVk
g+Iuy+LaZv8esl9kkkhgbe3pI1l7p9eGnNb+tJqtQO3+//63mouYRNCjmKeg
Na2Hj8RB0eowEnrxGiSuQva+nEzELKvjcJWNJFfNZ4TCyenH+o4TM+mndBbK
sQyTWRnGor0XCtIwmsqU/1YXZhCnWxk3n9Fm77NsArbm5GS/oULKTA7RtPw0
MWI8C+DT7XYZH4EF4FERBFdTqRiYo3Im0oIBR6JcjoRiPGVk8dYbvCJjfJIL
weDvQVHA8rIAADj7skzgr/ciFTkvYG7I9H4VzFiMZQpziqlgqYBTUaB+LBcT
CQhKAwYfHg4vVlrbQzK3B2g1YSpsRHTOZBwnAoh+wdil+Ecpc4F0KpZmBWGE
DBDsBmz+HUiBYhunH4dXGx39Lzs7p78vD//j4/Hl4QH+PTwanJy4PwIzY3h0
/vHkoPqrWrl/fnp6eHagF8Moqw0FG6eDv8MTEEq2cX5xdXx+NjjZAHkAmv1z
ATOPfB4JeAQ6DOQXImZcBfbAYlzzdv/if/6r95J9/vxPl+/2+73ej1++mC+v
ez+8hC93U5Hq3bI0WZivwN5FwOdzwXOEwpOERXwuC54omKuYmmZ3KZui6Qj+
8rcEzot1d//2V+IqOJg8i8uo4uXjDgqwOu4ehDXHZ10e4DmTqZzJ34xgZKDJ
UwAJyKgskhxpv5PFlPYaLVhk9wGTO8pg3ArMVOOB9PI4logkT9gYvAscNUIg
Rgum0H8C0DmPbkQRorO+YGUhE0JhjVCzzcH48v0WAOL6oMCyRKDoAA+nCx5N
nYNmA0MBrRsOtsDIibzggAcCAV9wK+AAwDnHCzhtkTKhCj5KpJoCuBhgAImI
8XAA6jLJCgNqnmeoO/Aoz8rJVKtuyBrKNuYRkASCb/hKakvylWk+5Gg+UtyD
sKlDw+OGU4QwIUvYORzJrRR3QTBQDMx6ifak0GL4+fNYTrqZmfHlCwocjEtE
NstJgtOYCMksk2n3tcGUTIGhM9gPFHguYCqcvTKwOIMp1xeX5xfnw8EJOwPW
jBfsgi+SjNc4B8RcDz5eHZFU7F8eDq4Or/ePjk8OroGnwgR+Cnkn6iBlGiVl
jKaRwXkAz8aI3jxTpCd0zCSIkuQQSCYpOgMTDieawRCJLAeMae3jpGq1noCT
Thf6rBDG3VRGWvgrbt+h6ChktRbLBZg+wH8mtf1TzBgsMC1APBIYd5gMRUin
RqBBhshaKJQUOTYao9lOx3DH0aRqAYqEvHUPcFeRiKhAssuRoZxE7xY8Egg2
hNg8KZHfAzYBj222BKuIGOUCjJLT9liOx2CEAAm9BmUNjLbeBzQAnKTwDodH
kZgXjT1yCuvhKZybkviM9jMAzbYSaIu4trDsTiQJyP4xAHTnDQedotKSmyzT
mxQNpD3tDiAF4+Zc0KBW64CVZjqZXa11QJGkGM5MmoEyIRqxVBEH+mKUc81d
Nc9SIDhkgE6apcKyU/MdZjqJJEsUo3rHHic6dThEcDTNMkXuxWyolfFhbQrZ
mQDlhlkgsiD6skC6QAZkJOfENjKF9Z0w9qsOCezap3nCUy3qKLu5+BXkhDQH
JiIvHSlErYbGFRo7bTFJqK2Mat3Cw2gee5NkI+8gWugAtUqenTtawRacDw/P
miQHAYSWGFCKZNGxSmC4DiYtxjMcSzIOqpR6e0sAcYjoN1g4bFeZLOKhszm4
HRwUqJ0DC2xJwVEreHqHzpnmaGZwCnCIx3AmBeouWv24yYvaobjlZYrnikhD
dIYpmOY0wkhjlA/iK3hJNHlaXU2whFKL/gQOFaRglhFSQCdKaiFnsOYXFPoZ
wJRzp5ckqgYL7TO59aGRhr8pgGGAb3PhSJCpsUth5S2E/rzS8pYN2GppgEXd
sqGOtSEVnYHTT7fEWAFSdrclIgzi8hHgawGZa2uUrpeyTsN2T7mJf+aFCbRz
DAdyrVsP+S7Y/BdrWipYRlZVS7kfQsXKrEAWgPDQQscDwAWCilKzqsDJPJGT
VEdV3tYkXnqJjsJQUkmeyIlnKJ/wHbxmRmZcfIJIqbC+GvAEar5+/RocO0Ie
+lzaI8XA/3s/wdHBZQeCrA77cCg77EyybvevwYN7M/YXSDa8NTmsyQ2QD+zz
8QEAwaCjo2HgpKuhxP/lZuhs0z+UaivL8evjgze9jnMybzZsqrPho4XCd839
kTAMWxNksPyxv1f/mfb6detxbCMu5TUurfksYeKaz0M8Xvl5GlNWfjTH9N+P
XtRg6voNfu08HjgtuHnCgidjU26R/n7eYy/8rABsfgEZ902XzMabjUhgXrvB
qBr7ZgPt7ZznwGcY1QGyZbfOkVq5kc1V1pg3ZyTReVKODYEE+LWoFSeg8QXD
azySyRLReVduXcfbNR9d5X6Pi+91BM9HFFubSAaMrnG8zk5CcoqcgLRYxDaa
3fgSUAq+IogIAp2LpTQKeXVV31kX4wXa7rJt1mN9tsNesldsl/3AXrMfnzIW
/Ev3O/8L7iHc/FS4uIjd79+DtT8cHl7+fHgAYnbvBM5OORHpBLyQ+dw/Cw5V
6nt8oPccXhyzIeauFQ6Gh6dYxoJo4GoxF8+Hg69G+kDXKFH9RFFcUK1M9cPn
aYft5+BeI3DSb2XRcczVlaIGV3VeMSZJhNhHCar9sJ2wt41xji43/dD/cRfS
0yDwubbZY1lUiGJrL9ijLBik+zeRZzDN8XLFnGXM3ezr6YrmD43yaekucEKG
eRKG5pHWupleDepPSYvZ4ertoKfLm23LYcMp0lCTiLlopLNOj7xMsV01YLXq
nVZVGy5hct/at7JOT9gWyxGYjdhSyOo9/0BqX0WbVuVcQcVpnJtS1/nnU/vv
+twHXx9+6FA/4AV/aNLXZ8DheU1PFc+vND6WOjA7LPAPsqbhaJDScjaqcuiF
jf2rNDcIqkpatZqZ5S73zm0xxM0O2aYSAoQcwoS9aTTvYj/ly5ctFgRNuakb
EoSb6AdYY6IHzIKvnZsHCb/i4sGyMpGt+nlBjasX5wLrnci+mPLXK8glFVY6
qxgCjdMMplfWtYM1ZWN5d8JX4NvRVkOUwGWCMUuZU8bMW0YGDHa3woKM9Iu1
wcrnF41lEB48siw+zpIku9PBEZ6gocSktstoXUVklM1tYT3CgkwqBcRulSnj
FgoR9kcxZQOrxBWRVWxgbNng3Zttf4Jn0O6D+3erzYCF0PMh/Ixx4vMZgWUY
NJFeZcruH4LQo8BJi8JMFqgG/z+mzAnLumxkiZDWo6ocq+fo3gEMw9LxJKPu
JRZ+nJrssd4Wm6CCyMgbtnkEmgI+x4od1at4lGdK2WqoIvVWkDwJXXuZYs5i
ggJjPrTa4ZbYiBjJ1A2gJiodzfW39LfK/KDFyLD7RUU+0HGIBMuEUzBES7BU
jgVBjgXiAtKdwpbFwHS80CqPlTpHkekq2xqeRsN2eqlQds3H+eS6ciUIvAVn
uVnxOhmaBL9vEPEUa5C66WD6BlSBd+U5kzwFwT+zA6HgtAnq3lK0YE6FzDuy
W3tsuzZKRh90VSdv1zOqBsbmC/+EyOAZUT+znNEzGKa/TQ3TeBW9KaBMiHSw
dotNMLJ1aECtW1whi8a06mpllOUmWqR2Xl1DpSkoZynKal1OWjTgMV+BaNxm
MmYc5GpSymJhy/5ejTnXDXZTuqZG7HKm5GKsmzbOKdhY3XkYWmDbCAtbIY40
R1BcKudDFUfDTBIyy6plTLf9El0D0P1RqmMq5IYC+aYml22yG9HV3UO/4Yow
o6pRGdrcaoIl0ZFAj1d1RZXfAtL1bbsWqMHcZySKO6xo7BLg12wEzMWeYUhP
kXpvgdf1PBm+7TCVUZRS5tQNqHhOTRkGQnCt5vI6USOtIybn2a2fCU6uzTXT
XoeM5KkFBq8n2GjDtNFdiYYiMB1qVPfYIAAzUQrt1Qc6ChdmOQHV0guUYqkf
KNSKO/caaJVmYLCk5bhm7dwBN62Mo3eJhP9RQoVt6yQJd02Go4A8fStEeAN4
2Bj1WRx9z3fU/sG7aKMZZLwBNjyrm/4mHF4/Lw61WGGpQK2MGo6t/ntiWSqx
SkKd+fIcFhoArSRU8HvBLulylMjNrYeHL03ooD0XE1g30P3pVIhY6UaSBmK6
kDq5KvgN2KBxns1aOZPLHbyxjl/xNF6eTHa9ypjNjetWfoLWsb11mwlU3X3q
oKG/1Zcq8GvH6Plyn4axtJ4xeOc3fRteDwA2ZUZ7GXhu6q16lBp8I6+YGxLj
3T2Lmq0jU/eibeqYjYJMBuPfdIuyGGxaJvW1CROH4dmYKMxep3MtWesfMLzU
1/LwfoV6IL3DI/9CIY492j1WtSvoSpcrU9Oi+ll3WicdYig0rB303porXMYh
uthlXbbolRUhtQ8OhoC5J9T/eiA8d8sGmqeb+weDrVYoF6tofh3FfGn41quN
0nnvMb3bwYA0QNE9CLxhZ6MKPK6YbqFRT5j8VpPzDoQWIa2k+YKxTc1ei5Sv
StXYFtHgyeCe1gkzRHh49cqNNCuuq4hgA0sk+2ffyi8RpU9jF+31XdwiK2Cg
NBhm+GWQ8tnlhr6fW+8wQDvhEKixb+XaGEBcJwjiaczztv5+HjaALWflOGly
0o48g9iBBXyL2A3QB+LdjxajuHvyaB7VIX4nj95CLF3BWs4iwtHnkBl4KoN2
X2LovmFT+sphKZfu2Es0xxe3uxTnO/7o0LcOGzymhunuBNf9LaVSDngNHAYb
cb116gu355apcpgJfWkIGZrjRRhdYoMAJpaRvnFSgc79u9SA4+W7ffZyZ3sH
26oQVtirLNWCyuHoYonLuWZzQGKE11IX1d2R4f7Rfg3ZMaaFGGu5pisdNEDX
HlMTA3DHY7xQkmI6CgzDlA4IoF5VKihYw9QfWQF5NMRIOWtbQ4g1C/3wCRbR
g/j7S6uHYs0++sNPldzzub4d7WRXpFSGslepHXV0C70yApg7udvNFy59P05j
8YltQvC6BWkKVwUbAk0kt0DWW2xqb0LyusQZVaH+49mPMTJAMyLh7jebzgLI
50j6kZa7MIbt9XRs2mkAxFQEbEdCubhrm3Rkp0+B0GPYutP3JJX0HrubJv51
NgDxtlfQ7RgwGzn6j5IK22calc3h2bfwMX0iG8/+nFw8W85Eej9hcDbAt4IU
YGrMXUBVS6NTLjvTUfWSHrMCAScoeCGEQzirbwa7y4F2740VELpsWPCiVPrr
hn2/ZbFn6g5Vqb6+vLny8VfbACY1tRmrtYlpu2XVWTToQplb3EQunCoYMDSq
nK3KMnNnnHSvrZ45bLXyvO95y8c6so65dagaad6yzEL5iGG6jQ3ACqcOvQTj
apc20ZzNE/JuiGf9LurP5s5q41UUl6o2t+veYmN9C+0kHK6o7kbjfR628TC1
KCZjrGNrKudljgXi6sa3ZruvIJnJoFA1EYLmq/cijO9SS2XrpC48ANM9zeIs
ySYLvHwgE1HbCveY8RTkMiZFNu9uxPrFASVvBXjd0cKoEm7tKqawk7931Ujs
0P0mFYEDR/D0YoI2KQ+gXYtV6NUWmq33BFgiGYOHH9BlaydeaK426vmreRss
3ggZq1mEBWHebmqsaIzuTUTaJdECUN8Cxlz1GFQyZcv0xj3//XDoChwY5Bkh
qBdEVrUGKlDb/8YybA3fSRAm6d+C6ekAlIR4HysUF1ih8C50U+jm3/XORWkK
0ngF+tJjeEM78LFVYlMBVlOem7X6EjpJLFZa7lkLh3v2roRZ5u4Hlf98d9do
E7b8HQxdCqouRSK4b1vL1tCSOaueeUOI/e6rVzuvaghdDs7eH2qq9MCy6p+d
vN3qe5JDhRibqpEYATqBg2CWU7BG+plWlUVksX+xAG8Q3WV+32RzaS0cDDZ1
bupdp36XAtZG+9q08hvFJO/+V6PBknCKEm3vpAr8zVuH0lldMtxhWy21mq+r
eVb+h6RJO9fNHqWVW8BNX3I8yYC/28Jx/+A36mdvNw7K2VL/2Jhpfve6/Vev
vMllWsUT8LhbFa/tOXuENFnhdnqciVpqntYtfaJb/qOYMV17fDSDnH9T7v6g
kp+0tnr3dbxOp73/WDuHqpALngnb6K1AVUvvkvc2yfACHZ526otBpqGK+zjl
aLnth0/GNtPsW50e/NxKfUtrO+Yb5PM9/fJmDLMTOk/6uQowHSKchB1d8zTv
1ejrC+bNVcsfXGrJrb+/SqGl1xiht1jYcBB+s/n/faz+ckfQsPdNg31fVYPt
gC31enN6TTPv2Xk0Fq2HtmDqBkxB1J+zBmi/9bBRQbxv1DUfA3Sn9bAqYJgB
Xh9YA5Qh1JetpzbLr+hvtgXXQ33VegrZ43KoKnVD66Dugu3u/2dvt9u3T33T
zuxt1W4dgvl0G2P03XkA4+U98+/nSz+7OyTf4A4oM9HB74uH+xd6vmtVBIF/
rYw19bDhTldqUt2Zemp0z+qF5qYr9ZTjnoG4Cv+tsObUfvVANe6m1abiOzA7
1kG3DtA7Gt8/e2xBJj7Q0tAstO2LPx8Hn8qVilJkyuoeheaNaUgE7E/Hm+rB
ROuYu73YnLpTTcU3Gh4URJj68qkct/zTUtjqyVilp6ZGQ/5WBMMP8ncFb/Xd
peVkeXzt7VbzVvB0p//wNI+fpkXyFF4u56PlUGDYaKveRoO9Avvvy8VTjBiL
DO3vKi7aov1SLj6F7jplL6rfK2mWTq/0VUX9To/3GlD952pcgWaWxVjOND9H
Ul2Wx0LSQv/mhNVCAHIL+WFWKnbHF7opxauLX8vme6+JwxK8B2deRlYMf9+s
0D9tcityzB38H6jAX1C48l/gd/diIkMv46Msd6G2fWtQ1wqLLGOzErJuwCQr
88jk2jpWN1dFIvyRh0TEE90j04zTP5ymXNlqKmTOJsjboozpXu+Q4w9zsP0p
v8n5CHKIDrtCW/EBf1QDf6vnVAImYEkv8d9cmYIYiKIAWRnOFirJbm10AMDp
d0fwzXumyvkcKNJ0W0TusjKJWSJvaHNeIa3zFr1EXwg6Bbyi6gdm8LkZGkSR
SHT7DU4LyJkBD/4PjaRb1lpPAAA=

-->

</rfc>

